---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "seqera_container_registry_credential Resource - terraform-provider-seqera"
subcategory: ""
description: |-
  Manage container registry credentials in Seqera platform using this resource.
  Container registry credentials store authentication information for accessing
  container registries (Docker Hub, ECR, GCR, ACR, etc.) within the Seqera Platform workflows.
---

# seqera_container_registry_credential (Resource)

Manage container registry credentials in Seqera platform using this resource.

Container registry credentials store authentication information for accessing
container registries (Docker Hub, ECR, GCR, ACR, etc.) within the Seqera Platform workflows.

## Example Usage

```terraform
# Seqera Container Registry Credentials Examples
#
# Container registry credentials store authentication information for accessing
# container registries (Docker Hub, ECR, GCR, ACR, etc.) within the Seqera Platform workflows.
#
# SECURITY BEST PRACTICES:
# - Never hardcode credentials in Terraform files
# - Use Terraform variables marked as sensitive
# - Store actual credentials in secure secret management systems
# - Use least-privilege access tokens when available
# - Regularly rotate credentials
# - Use registry-specific service accounts or tokens

# Variable declarations for sensitive container registry credentials
variable "registry_username" {
  description = "Container registry username"
  type        = string
  sensitive   = true
}

variable "registry_password" {
  description = "Container registry password or access token"
  type        = string
  sensitive   = true
}

# =============================================================================
# Example 1: Docker Hub Credentials (Default Registry)
# =============================================================================
# Basic configuration for Docker Hub. Registry field can be omitted or set to docker.io

resource "seqera_container_registry_credential" "docker_hub" {
  name         = "dockerhub-main"
  workspace_id = seqera_workspace.main.id

  user_name = var.registry_username
  password  = var.registry_password
  registry  = "docker.io"
}

# =============================================================================
# Example 2: Docker Hub with Access Token (Recommended)
# =============================================================================
# Use Docker Hub Personal Access Tokens instead of passwords
# Create tokens at: https://hub.docker.com/settings/security

resource "seqera_container_registry_credential" "docker_hub_token" {
  name         = "dockerhub-token"
  workspace_id = seqera_workspace.main.id

  user_name = var.dockerhub_username
  password  = var.dockerhub_access_token # Use PAT instead of password
  registry  = "docker.io"
}

# =============================================================================
# Example 3: AWS Elastic Container Registry (ECR)
# =============================================================================
# For ECR, use AWS credentials. Username is typically "AWS"
# Password is obtained via: aws ecr get-login-password

resource "seqera_container_registry_credential" "aws_ecr" {
  name         = "aws-ecr"
  workspace_id = seqera_workspace.main.id

  user_name = "AWS"
  password  = var.aws_ecr_password # From: aws ecr get-login-password
  registry  = "123456789012.dkr.ecr.us-east-1.amazonaws.com"
}

# Note: ECR passwords expire after 12 hours, consider using AWS credentials
# resource instead for automatic token refresh

# =============================================================================
# Example 4: Google Container Registry (GCR)
# =============================================================================
# For GCR, username is "_json_key" and password is the service account JSON key

resource "seqera_container_registry_credential" "gcr" {
  name         = "google-gcr"
  workspace_id = seqera_workspace.main.id

  user_name = "_json_key"
  password  = var.gcp_service_account_json # JSON key as string
  registry  = "gcr.io"
}

# Alternative GCR registries:
# - gcr.io (multi-region)
# - us.gcr.io (US)
# - eu.gcr.io (Europe)
# - asia.gcr.io (Asia)

# =============================================================================
# Example 5: Google Artifact Registry (GAR)
# =============================================================================
# Artifact Registry is the successor to GCR

resource "seqera_container_registry_credential" "gar" {
  name         = "google-gar"
  workspace_id = seqera_workspace.main.id

  user_name = "_json_key"
  password  = var.gcp_service_account_json
  registry  = "us-docker.pkg.dev"
}

# Region-specific registries:
# - us-docker.pkg.dev
# - europe-docker.pkg.dev
# - asia-docker.pkg.dev

# =============================================================================
# Example 6: Azure Container Registry (ACR)
# =============================================================================
# For ACR, use admin username/password or service principal credentials

resource "seqera_container_registry_credential" "acr" {
  name         = "azure-acr"
  workspace_id = seqera_workspace.main.id

  user_name = var.acr_username # Admin username or service principal
  password  = var.acr_password # Admin password or service principal secret
  registry  = "myregistry.azurecr.io"
}

# Enable admin user in ACR:
# az acr update --name myregistry --admin-enabled true
# az acr credential show --name myregistry

# =============================================================================
# Example 7: GitHub Container Registry (GHCR)
# =============================================================================
# Use GitHub Personal Access Token with packages:read scope

resource "seqera_container_registry_credential" "ghcr" {
  name         = "github-registry"
  workspace_id = seqera_workspace.main.id

  user_name = var.github_username
  password  = var.github_pat # Personal Access Token with packages:read
  registry  = "ghcr.io"
}

# =============================================================================
# Example 8: GitLab Container Registry
# =============================================================================
# Use GitLab Personal Access Token or Deploy Token

resource "seqera_container_registry_credential" "gitlab_registry" {
  name         = "gitlab-registry"
  workspace_id = seqera_workspace.main.id

  user_name = var.gitlab_username
  password  = var.gitlab_token # Personal Access Token or Deploy Token
  registry  = "registry.gitlab.com"
}

# For self-hosted GitLab:
# registry = "gitlab.mycompany.com:5050"

# =============================================================================
# Example 9: Quay.io Container Registry
# =============================================================================
# Use Quay.io robot account credentials

resource "seqera_container_registry_credential" "quay" {
  name         = "quay-registry"
  workspace_id = seqera_workspace.main.id

  user_name = var.quay_robot_username # Format: namespace+robot_name
  password  = var.quay_robot_token
  registry  = "quay.io"
}

# =============================================================================
# Example 10: Multiple Container Registries
# =============================================================================

locals {
  container_registries = {
    "dockerhub" = {
      username = var.dockerhub_username
      password = var.dockerhub_token
      registry = "docker.io"
    }
    "gcr" = {
      username = "_json_key"
      password = var.gcp_service_account_json
      registry = "gcr.io"
    }
    "ecr" = {
      username = "AWS"
      password = var.aws_ecr_password
      registry = "123456789012.dkr.ecr.us-east-1.amazonaws.com"
    }
  }
}

resource "seqera_container_registry_credential" "multi_registry" {
  for_each = local.container_registries

  name         = "registry-${each.key}"
  workspace_id = seqera_workspace.main.id
  user_name    = each.value.username
  password     = each.value.password
  registry     = each.value.registry
}

# =============================================================================
# Example 11: Private Self-Hosted Registry
# =============================================================================

resource "seqera_container_registry_credential" "private_registry" {
  name         = "private-registry"
  workspace_id = seqera_workspace.main.id

  user_name = var.private_registry_username
  password  = var.private_registry_password
  registry  = "registry.mycompany.com:5000"
}

# =============================================================================
# Example 12: JFrog Artifactory Container Registry
# =============================================================================

resource "seqera_container_registry_credential" "artifactory" {
  name         = "jfrog-artifactory"
  workspace_id = seqera_workspace.main.id

  user_name = var.artifactory_username
  password  = var.artifactory_api_key # Use API key instead of password
  registry  = "mycompany.jfrog.io"
}

# =============================================================================
# Example 13: Harbor Container Registry
# =============================================================================

resource "seqera_container_registry_credential" "harbor" {
  name         = "harbor-registry"
  workspace_id = seqera_workspace.main.id

  user_name = var.harbor_username
  password  = var.harbor_password
  registry  = "harbor.mycompany.com"
}

# =============================================================================
# Creating Docker Hub Access Tokens
# =============================================================================
# To create a Docker Hub Personal Access Token:
#
# 1. Log in to Docker Hub: https://hub.docker.com
#
# 2. Go to Account Settings > Security:
#    https://hub.docker.com/settings/security
#
# 3. Click "New Access Token"
#
# 4. Configure token:
#    - Description: "Seqera Platform"
#    - Access permissions: Read-only or Read & Write
#
# 5. Click "Generate"
#
# 6. Copy the token immediately (shown only once)
#
# 7. Use token as password in credentials

# =============================================================================
# AWS ECR Authentication
# =============================================================================
# To authenticate with AWS ECR:
#
# Option 1: Get temporary password (expires in 12 hours):
# aws ecr get-login-password --region us-east-1
#
# Option 2: Use AWS credentials resource (recommended):
# Use seqera_aws_credential resource for automatic token refresh
#
# Option 3: Use IAM roles with ECS/EKS (compute environment level)

# =============================================================================
# GCP GCR/GAR Authentication
# =============================================================================
# To authenticate with GCR/Artifact Registry:
#
# 1. Create a service account:
# gcloud iam service-accounts create seqera-registry \
#   --display-name="Seqera Container Registry Access"
#
# 2. Grant required roles:
# gcloud projects add-iam-policy-binding PROJECT_ID \
#   --member="serviceAccount:seqera-registry@PROJECT_ID.iam.gserviceaccount.com" \
#   --role="roles/artifactregistry.reader"
#
# 3. Create and download key:
# gcloud iam service-accounts keys create key.json \
#   --iam-account=seqera-registry@PROJECT_ID.iam.gserviceaccount.com
#
# 4. Use the entire JSON key file content as the password

# =============================================================================
# Azure ACR Authentication
# =============================================================================
# To authenticate with Azure Container Registry:
#
# Option 1: Enable admin user (for testing):
# az acr update --name myregistry --admin-enabled true
# az acr credential show --name myregistry
#
# Option 2: Use service principal (recommended):
# az ad sp create-for-rbac --name seqera-acr --role acrpull \
#   --scopes /subscriptions/SUBSCRIPTION_ID/resourceGroups/RG/providers/Microsoft.ContainerRegistry/registries/REGISTRY
#
# Use appId as username and password as password
#
# Option 3: Use Azure credentials resource for automatic token refresh

# =============================================================================
# SECURITY RECOMMENDATIONS
# =============================================================================
#
# 1. Use registry-specific access tokens instead of passwords when available
# 2. Grant minimum required permissions (read-only when possible)
# 3. Use service accounts or robot accounts instead of personal accounts
# 4. Set token expiration dates and implement rotation
# 5. Store credentials in secure secret management systems
# 6. Use cloud provider credentials resources (AWS, GCP, Azure) for automatic refresh
# 7. Monitor registry access logs for unauthorized usage
# 8. Revoke credentials immediately if compromised
# 9. Use separate credentials for different environments (dev, staging, prod)
# 10. Enable multi-factor authentication on registry accounts
# 11. Regularly audit and rotate credentials
# 12. Use pull-through cache registries to minimize external dependencies
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Display name for the credential (max 100 characters). Requires replacement if changed.
- `password` (String, Sensitive) Password or access token for container registry authentication (required, sensitive)
- `user_name` (String) Username for container registry authentication (required)

### Optional

- `registry` (String) Container registry server URL (optional). Examples: docker.io, gcr.io, account.dkr.ecr.region.amazonaws.com
- `workspace_id` (Number) Workspace numeric identifier

### Read-Only

- `credentials_id` (String) Unique identifier for the credential (max 22 characters)
- `provider_type` (String) Cloud provider type (automatically set to "container-reg"). Default: "container-reg"; must be "container-reg"

## Import

Import is supported using the following syntax:

In Terraform v1.5.0 and later, the [`import` block](https://developer.hashicorp.com/terraform/language/import) can be used with the `id` attribute, for example:

```terraform
import {
  to = seqera_container_registry_credential.my_seqera_container_registry_credential
  id = "..."
}
```

The [`terraform import` command](https://developer.hashicorp.com/terraform/cli/commands/import) can be used, for example:

```shell
terraform import seqera_container_registry_credential.my_seqera_container_registry_credential "..."
```
