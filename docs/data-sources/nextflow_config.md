---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "seqera_nextflow_config Data Source - terraform-provider-seqera"
subcategory: ""
description: |-
  Generates Nextflow configuration in Groovy format from structured HCL blocks. This data source provides a type-safe way to build Nextflow configurations that can be validated at plan time, similar to how aws_iam_policy_document generates JSON policy documents.
---

# seqera_nextflow_config (Data Source)

Generates Nextflow configuration in Groovy format from structured HCL blocks. This data source provides a type-safe way to build Nextflow configurations that can be validated at plan time, similar to how `aws_iam_policy_document` generates JSON policy documents.

## Example Usage

```terraform
# Nextflow Config Data Source Examples

# Example 1: Basic local configuration
data "seqera_nextflow_config" "local" {
  process {
    executor = "local"
    cpus     = 2
    memory   = "4 GB"
  }
}

output "local_config" {
  value = data.seqera_nextflow_config.local.config
}

# Example 2: HPC with PBS Pro and multiple labels
data "seqera_nextflow_config" "pbspro" {
  process {
    executor       = "pbspro"
    queue          = "workq"
    cpus           = 4
    memory         = "16 GB"
    time           = "4h"
    error_strategy = "retry"
    max_retries    = 2

    # High memory processes
    with_label {
      name            = "big_mem"
      memory          = "128 GB"
      time            = "24h"
      queue           = "highmem"
      cluster_options = "-l select=1:ncpus=8:mem=128gb"
    }

    # GPU processes
    with_label {
      name            = "gpu"
      queue           = "gpu"
      cluster_options = "-l select=1:ncpus=4:ngpus=2"
    }

    # MPI processes
    with_label {
      name            = "mpi"
      queue           = "mpi"
      cluster_options = "-l select=4:ncpus=16:mpiprocs=16"
    }
  }

  executor {
    queue_size          = 100
    poll_interval       = "30 sec"
    submit_rate_limit   = "10 sec"
  }

  singularity {
    enabled     = true
    auto_mounts = true
    cache_dir   = "/shared/singularity/cache"
    run_options = "--bind /lustre:/lustre"
  }
}

# Example 3: Slurm with process name patterns
data "seqera_nextflow_config" "slurm" {
  process {
    executor = "slurm"
    queue    = "compute"

    # Override for alignment processes
    with_name {
      pattern = "align_*"
      cpus    = 16
      memory  = "64 GB"
      time    = "12h"
    }

    # Override for STAR aligner specifically
    with_name {
      pattern         = "STAR"
      cpus            = 32
      memory          = "128 GB"
      cluster_options = "--gres=disk:500"
    }

    # GPU processes
    with_label {
      name            = "gpu"
      queue           = "gpu"
      cluster_options = "--gres=gpu:1"
    }
  }

  executor {
    queue_size = 200
  }

  singularity {
    enabled   = true
    cache_dir = "/scratch/singularity"
  }
}

# Example 4: Docker configuration
data "seqera_nextflow_config" "docker" {
  process {
    executor  = "local"
    container = "biocontainers/samtools:1.15"
  }

  docker {
    enabled = true
    remove  = true
  }
}

# Example 5: Advanced with raw_config
data "seqera_nextflow_config" "advanced" {
  process {
    executor = "pbspro"
    queue    = "workq"

    with_label {
      name   = "high_throughput"
      cpus   = 1
      memory = "2 GB"
      time   = "30m"
    }
  }

  executor {
    queue_size = 500
  }

  # Add advanced configuration not in schema
  raw_config = <<-EOF
    // Reporting
    report {
      enabled = true
      file    = 'pipeline_report.html'
    }

    trace {
      enabled = true
      file    = 'pipeline_trace.txt'
      fields  = 'task_id,hash,native_id,name,status,exit,submit,start,complete,duration,realtime,%cpu,rss'
    }

    timeline {
      enabled = true
      file    = 'timeline.html'
    }

    // Manifest
    manifest {
      name        = 'example-pipeline'
      description = 'Example genomics pipeline'
      version     = '1.0.0'
    }
  EOF
}

# Example 6: Composable base + environment-specific
data "seqera_nextflow_config" "base" {
  executor {
    queue_size        = 100
    poll_interval     = "30 sec"
    submit_rate_limit = "10 sec"
  }

  singularity {
    enabled     = true
    auto_mounts = true
    cache_dir   = "/shared/singularity/cache"
  }

  raw_config = <<-EOF
    report.enabled = true
    trace.enabled = true
  EOF
}

data "seqera_nextflow_config" "production" {
  process {
    executor       = "pbspro"
    queue          = "production"
    error_strategy = "retry"
    max_retries    = 3

    with_label {
      name   = "critical"
      queue  = "priority"
    }
  }

  # Append base configuration
  raw_config = data.seqera_nextflow_config.base.config
}

# Example outputs
output "pbspro_config" {
  value       = data.seqera_nextflow_config.pbspro.config
  description = "Generated PBS Pro configuration"
}

output "slurm_config" {
  value       = data.seqera_nextflow_config.slurm.config
  description = "Generated Slurm configuration"
}

output "production_config" {
  value       = data.seqera_nextflow_config.production.config
  description = "Generated production configuration with base settings"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `docker` (Block, Optional) Docker container engine configuration (see [below for nested schema](#nestedblock--docker))
- `executor` (Block, Optional) Executor configuration block defining job scheduling and polling behavior (see [below for nested schema](#nestedblock--executor))
- `process` (Block, Optional) Process configuration block defining default process directives and per-label/per-name overrides (see [below for nested schema](#nestedblock--process))
- `raw_config` (String) Raw Groovy configuration to append to the generated config. Use this for advanced options not supported by the structured schema.
- `singularity` (Block, Optional) Singularity/Apptainer container engine configuration (see [below for nested schema](#nestedblock--singularity))

### Read-Only

- `config` (String) The generated Nextflow configuration in Groovy format
- `id` (String) Unique identifier (hash of the generated configuration)

<a id="nestedblock--docker"></a>
### Nested Schema for `docker`

Optional:

- `enabled` (Boolean) Enable Docker container engine
- `registry` (String) Docker registry URL
- `remove` (Boolean) Remove containers after execution
- `run_options` (String) Additional options for docker run
- `temp` (String) Temporary directory for Docker


<a id="nestedblock--executor"></a>
### Nested Schema for `executor`

Optional:

- `exit_read_timeout` (String) Timeout for reading exit status from completed jobs
- `poll_interval` (String) Interval for checking job status (e.g., '30 sec', '1 min')
- `queue_size` (Number) Maximum number of jobs the executor can submit to the queue simultaneously
- `queue_stat_interval` (String) Interval for checking queue statistics (e.g., '5 min')
- `submit_rate_limit` (String) Rate limit for job submission (e.g., '10 sec', '100/1min')


<a id="nestedblock--process"></a>
### Nested Schema for `process`

Optional:

- `cluster_options` (String) Default cluster-specific submission options
- `container` (String) Default container image
- `container_options` (String) Default container runtime options
- `cpus` (Number) Default number of CPUs per process
- `disk` (String) Default disk space allocation
- `error_strategy` (String) Error handling strategy: 'retry', 'ignore', 'terminate', or 'finish'
- `executor` (String) Executor type (e.g., 'pbspro', 'slurm', 'awsbatch', 'k8s', 'local')
- `max_errors` (Number) Maximum number of errors before stopping the pipeline
- `max_retries` (Number) Maximum number of retry attempts
- `memory` (String) Default memory allocation (e.g., '16 GB', '4096 MB')
- `queue` (String) Default queue name for job submission
- `time` (String) Default time limit (e.g., '4h', '30m', '1d')
- `with_label` (Block Set) Process label-specific overrides using withLabel selector (see [below for nested schema](#nestedblock--process--with_label))
- `with_name` (Block Set) Process name pattern-specific overrides using withName selector (see [below for nested schema](#nestedblock--process--with_name))

<a id="nestedblock--process--with_label"></a>
### Nested Schema for `process.with_label`

Required:

- `name` (String) Label name (e.g., 'big_mem', 'gpu')

Optional:

- `cluster_options` (String) Cluster options override for this label
- `container` (String) Container image override for this label
- `container_options` (String) Container options override for this label
- `cpus` (Number) CPU override for this label
- `disk` (String) Disk space override for this label
- `error_strategy` (String) Error strategy override for this label
- `max_retries` (Number) Max retries override for this label
- `memory` (String) Memory override for this label
- `queue` (String) Queue override for this label
- `time` (String) Time limit override for this label


<a id="nestedblock--process--with_name"></a>
### Nested Schema for `process.with_name`

Required:

- `pattern` (String) Process name pattern (e.g., 'align_*', 'STAR', 'GATK_*')

Optional:

- `cluster_options` (String) Cluster options override for processes matching this pattern
- `container` (String) Container image override for processes matching this pattern
- `container_options` (String) Container options override for processes matching this pattern
- `cpus` (Number) CPU override for processes matching this pattern
- `disk` (String) Disk space override for processes matching this pattern
- `error_strategy` (String) Error strategy override for processes matching this pattern
- `max_retries` (Number) Max retries override for processes matching this pattern
- `memory` (String) Memory override for processes matching this pattern
- `queue` (String) Queue override for processes matching this pattern
- `time` (String) Time limit override for processes matching this pattern



<a id="nestedblock--singularity"></a>
### Nested Schema for `singularity`

Optional:

- `auto_mounts` (Boolean) Automatically mount host paths into containers
- `cache_dir` (String) Directory for caching container images
- `enabled` (Boolean) Enable Singularity container engine
- `env_whitelist` (String) Comma-separated list of environment variables to pass to containers
- `pull_timeout` (String) Timeout for pulling container images (e.g., '20 min')
- `run_options` (String) Additional options for singularity run (e.g., '--bind /data:/data')
