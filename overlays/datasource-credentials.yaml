overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Credentials List Data Source Overlay
  version: 0.0.1
actions:
  # Remove unwanted parameters from /credentials GET endpoint
  - target: $.paths['/credentials'].get.parameters[?(@.name == 'platformId')]
    remove: true

  # Credentials list data source - modify existing /credentials endpoint
  - target: $.paths['/credentials'].get
    update:
      x-speakeasy-entity-operation:
        terraform-datasource: Credentials#read
      x-speakeasy-name-override: ListCredentials
      summary: List credentials
      description: |
        Lists all credentials accessible to the authenticated user.
        Use `workspace_id` to filter credentials in a specific workspace context.
      tags:
        - credentials
      operationId: ListCredentialsDataSource
      parameters:
        - name: workspaceId
          in: query
          description: Workspace numeric identifier to filter credentials
          required: false
          schema:
            type: integer
            format: int64
      responses:
        "200":
          description: OK
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ListCredentialsDataSourceResponse"
        "400":
          description: Bad request
        "403":
          description: Operation not allowed
      security:
        - BearerAuth: []

  # ListCredentialsDataSourceResponse schema
  - target: $.components.schemas
    update:
      ListCredentialsDataSourceResponse:
        type: object
        required:
          - credentials
        properties:
          workspaceId:
            type: integer
            format: int64
            description: Workspace ID used for filtering
          credentials:
            type: array
            description: List of credentials
            items:
              type: object
              properties:
                id:
                  type: string
                  description: Credential ID
                name:
                  type: string
                  description: Credential name
                provider:
                  type: string
                  description: Provider type (aws, azure, google, github, gitlab, bitbucket, ssh, k8s, container-reg, tw-agent, codecommit, gitea)
        x-speakeasy-entity: Credentials
        x-speakeasy-entity-description: |
          Data source for listing credentials in Seqera platform.

          This data source returns all credentials accessible to the authenticated user,
          with optional filtering by workspace. Use Terraform locals with for expressions
          to filter by provider type or name.
