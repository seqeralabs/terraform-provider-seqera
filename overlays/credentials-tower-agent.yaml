overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Tower Agent Credentials Overlay
  version: 0.0.1
actions:
- target: $.paths
  update:
    /credentials#agent:
      post:
        x-speakeasy-entity-operation: TowerAgentCredential#create
        x-speakeasy-name-override: CreateTowerAgentCredentials
        summary: Create Tower Agent credentials
        description: Creates new Tower Agent credentials in a user context. Append `?workspaceId` to create the credentials
          in a workspace context.
        tags:
        - credentials
        operationId: CreateTowerAgentCredentials
        parameters:
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        requestBody:
          description: Tower Agent credentials create request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateTowerAgentCredentialsRequest'
          required: true
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CreateTowerAgentCredentialsResponse'
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
          '409':
            description: Conflict - resource already exists
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
        security:
        - BearerAuth: []
    /credentials/{credentialsId}#agent:
      get:
        x-speakeasy-entity-operation: TowerAgentCredential#read
        x-speakeasy-name-override: DescribeTowerAgentCredentials
        summary: Describe Tower Agent credentials
        description: Retrieves the details of the Tower Agent credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: DescribeTowerAgentCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/DescribeTowerAgentCredentialsResponse'
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
          '404':
            description: Not Found - Credential does not exist or has been deleted
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
        security:
        - BearerAuth: []
      put:
        x-speakeasy-entity-operation: TowerAgentCredential#update
        x-speakeasy-name-override: UpdateTowerAgentCredentials
        summary: Update Tower Agent credentials
        description: Updates the details of the Tower Agent credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: UpdateTowerAgentCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        requestBody:
          description: Tower Agent credentials update request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateTowerAgentCredentialsRequest'
          required: true
        responses:
          '204':
            description: OK - No content
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
        security:
        - BearerAuth: []
      delete:
        x-speakeasy-entity-operation: TowerAgentCredential#delete
        x-speakeasy-name-override: DeleteTowerAgentCredentials
        summary: Delete Tower Agent credentials
        description: Deletes the Tower Agent credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: DeleteTowerAgentCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        responses:
          '204':
            description: OK - No content
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
        security:
        - BearerAuth: []
- target: $.components.schemas
  update:
    TowerAgentCredential:
      required:
      - name
      - keys
      type: object
      properties:
        id:
          type: string
          description: Unique identifier for the credential (max 22 characters)
          x-speakeasy-name-override: credentialsId
          x-speakeasy-param-readonly: true
          x-speakeasy-param-suppress-computed-diff: true
        name:
          maxLength: 100
          type: string
          description: Display name for the credential (max 100 characters)
          x-speakeasy-param-force-new: true
        provider:
          type: string
          enum:
          - agent
          default: agent
          description: Cloud provider type (automatically set to "agent")
          x-speakeasy-name-override: providerType
          x-speakeasy-param-readonly: true
        deleted:
          type: boolean
          description: Flag indicating if the credential has been soft-deleted
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        lastUsed:
          type: string
          format: date-time
          description: Timestamp when the credential was last used
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        dateCreated:
          type: string
          format: date-time
          description: Timestamp when the credential was created
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        lastUpdated:
          type: string
          format: date-time
          description: Timestamp when the credential was last updated
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        keys:
          x-speakeasy-entity: TowerAgentCredential
          x-speakeasy-entity-description: 'Manage Tower Agent credentials in Seqera platform using this resource.


            Tower Agent credentials store connection IDs for Tower Agent instances that

            enable secure communication between the Seqera Platform and compute environments.

            '
          type: object
          required:
          - connectionId
          properties:
            connectionId:
              type: string
              description: Tower Agent connection ID (required). A unique UUID string used to identify the Tower Agent instance.
                Generate using random_uuid resource.
              example: 31e42060-7985-4727-aca1-4071c819ad8e
              x-speakeasy-param-computed: false
              x-speakeasy-name-override: connection_id
            workDir:
              type: string
              description: Working directory for the Tower Agent (optional)
              example: /work
              x-speakeasy-param-computed: false
              x-speakeasy-name-override: work_dir
    CreateTowerAgentCredentialsRequest:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/TowerAgentCredential'
    CreateTowerAgentCredentialsResponse:
      type: object
      properties:
        credentialsId:
          type: string
    UpdateTowerAgentCredentialsRequest:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/TowerAgentCredential'
    DescribeTowerAgentCredentialsResponse:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/TowerAgentCredential'
- target: $.components.schemas.TowerAgentCredential.properties.description
  remove: true
- target: $.components.schemas.TowerAgentCredential.properties.category
  remove: true
- target: $.components.schemas.TowerAgentCredential.properties.keys.properties.connectionId
  update:
    writeOnly: true
- target: $.components.schemas.TowerAgentCredential.properties.keys.properties.workDir
  update:
    writeOnly: true
