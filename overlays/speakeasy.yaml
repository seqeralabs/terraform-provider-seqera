overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Overlay seqera-api-latest.yml => seqera-final.yaml
  version: 0.0.0
actions:
  - target: $["components"]["schemas"]["AgentSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AltairPbsComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AwsBatchConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AwsCloudConfig"]["properties"]["forgedResources"]
    update:
      x-speakeasy-terraform-ignore: true
  - target: $["components"]["schemas"]["AwsSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AzBatchConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AzureEntraKeys"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AzureReposSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["AzureSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["BitBucketSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["CodeCommitSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["ComputeConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["ContainerRegistryKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GoogleSecurityKeys"]
    update:
      x-speakeasy-plan-validators: GoogleKeysCrdentialValidator

  - target: $["components"]["schemas"]["EksComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GitHubSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GitHubSecurityKeys"]["properties"]["password"]
    update:
      x-speakeasy-param-sensitive: true
  - target: $["components"]["schemas"]["GitHubSecurityKeys"]["properties"]["password"]
    update:
      x-speakeasy-param-suppress-computed-diff: true
  - target: $["components"]["schemas"]["GitLabSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GiteaSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GkeComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GoogleBatchConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["GoogleLifeSciencesConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  # - target: $["components"]["schemas"]["GoogleSecurityKeys"]["properties"]["data"]["type"]
  #   remove: true
  # - target: $["components"]["schemas"]["GoogleSecurityKeys"]["properties"]["data"]
  #   update:
  #     type: object
  - target: $["components"]["schemas"]["GoogleSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["K8sComputeConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["K8sSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["Launch"]["properties"]["id"]
    update:
      x-speakeasy-param-readonly: true

      ## Compute Config Schemas
      ## Security Keys Schemas
  - target: $["components"]["schemas"]["LsfComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["MoabComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["SSHSecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["SecurityKeys"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["SecurityKeys"]
    update:
      x-speakeasy-param-computed: false
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeSecurityKeys"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["SlurmComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["UnivaComputeConfig"]["allOf"][1]["properties"]["discriminator"]["readOnly"]
    remove: true
  - target: $["components"]["schemas"]["UserDbDto"]
    update:
      x-speakeasy-entity:
        - CurrentUser
        - User
  - target: $["components"]["schemas"]["Visibility"]
    update:
      x-speakeasy-param-optional: false
  - target: $
    update:
      servers:
        - url: https://api.cloud.seqera.io

  ####################################################################
  ####              Additional Entity Operations                   ####
  ####################################################################


  # User operations
  - target: $.paths["/user"].get
    update:
      x-speakeasy-entity-operation: CurrentUser#read
  - target: $.paths["/user/{userId}/workspaces"].get
    update:
      x-speakeasy-entity-operation: UserWorkspaces#read
  - target: $.paths["/users/{userId}"].get
    update:
      x-speakeasy-entity-operation: User#read

  ####################################################################
  ####              Property-Level Annotations                     ####
  ####################################################################
  # AWS Batch Config terraform-ignore
  - target: $.components.schemas.AwsBatchConfig.properties.forgedResources
    update:
      x-speakeasy-terraform-ignore: true

  # ComputeEnvResponseDto annotations
  - target: $.components.schemas.ComputeEnvResponseDto.properties.id
    update:
      x-speakeasy-name-override: computeEnvId
  - target: $.components.schemas.ComputeEnvResponseDto.properties.dateCreated
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnvResponseDto.properties.lastUpdated
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnvResponseDto.properties.lastUsed
    update:
      x-speakeasy-param-readonly: true

  # ComputeEnv_ComputeConfig_ annotations
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.id
    update:
      x-speakeasy-name-override: computeEnvId
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.dateCreated
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.lastUpdated
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.lastUsed
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.deleted
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.status
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.orgId
    update:
      x-speakeasy-param-readonly: true
  - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.workspaceId
    update:
      x-speakeasy-param-readonly: true


  # Entity annotations


  ####################################################################
  ####              Custom Error Handling                           ####
  ####################################################################


  # ComputeConfig discriminator and state change handling
  - target: $.components.schemas.ComputeConfig.properties.discriminator
    update:
      x-speakeasy-param-readonly: true
      x-speakeasy-terraform-ignore: true



  # Ignore discriminator fields in all security key schemas to prevent state changes
  - target: $.components.schemas.AgentSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.AwsSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.AzureReposSecurityKeys.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.AzureSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.BitBucketSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.CodeCommitSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.ContainerRegistryKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GitHubSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GitLabSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GiteaSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GoogleSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.K8sSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.SSHSecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.SecurityKeys.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.SeqeraComputeSecurityKeys.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true

  # Ignore discriminator fields in all compute config schemas to prevent state changes
  - target: $.components.schemas.AltairPbsComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.AwsBatchConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.AzBatchConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.EksComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GkeComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GoogleBatchConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.GoogleLifeSciencesConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.K8sComputeConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.LsfComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.MoabComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.SeqeraComputeConfig.properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.SlurmComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true
  - target: $.components.schemas.UnivaComputeConfig.allOf[1].properties.discriminator
    update:
      x-speakeasy-terraform-ignore: true

  # ####################################################################
  # ####              Missing Actions from overlay_new                ####
  # ####################################################################

  # # Update API version
  # - target: $.info.version
  #   update: 1.45.0

  # # Remove deprecated paths
  # - target: $.paths["/labels/dynamic/allowed"]
  #   remove: true

  # # Remove deprecated discriminator mappings
  # - target: $.components.schemas.ComputeConfig.discriminator.mapping.google-cloud
  #   remove: true
  # - target: $.components.schemas.ComputeConfig.discriminator.mapping.azure-cloud
  #   remove: true
  # - target: $.components.schemas.PlatformMetainfo.discriminator.mapping.seqeracompute
  #   remove: true
  # - target: $.components.schemas.PlatformMetainfo.discriminator.mapping.google-cloud
  #   remove: true

  # # Update platform enums
  # - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.platform.enum[*]
  #   remove: true
  # - target: $.components.schemas.ComputeEnv_ComputeConfig_.properties.platform.enum
  #   update:
  #     - aws-batch
  #     - aws-cloud
  #     - google-lifesciences
  #     - google-batch
  #     - azure-batch
  #     - k8s-platform
  #     - eks-platform
  #     - gke-platform
  #     - uge-platform
  #     - slurm-platform
  #     - lsf-platform
  #     - altair-platform
  #     - seqeracompute-platform


  # # Missing Speakeasy annotations
  # - target: $.components.schemas.Credentials.properties.baseUrl
  #   update:
  #     x-speakeasy-param-computed: false

  - target: $["components"]["schemas"]["AwsBatchConfig"]["properties"]["forgedResources"]
    update:
      x-speakeasy-terraform-ignore: true
  - target: $["components"]["schemas"]["ComputeConfig"]["discriminator"]["mapping"]["google-cloud"]
    remove: true
  - target: $["components"]["schemas"]["ComputeConfig"]["discriminator"]["mapping"]["azure-cloud"]
    remove: true
  - target: $["components"]["schemas"]["PlatformMetainfo"]["discriminator"]["mapping"]["seqeracompute"]
    remove: true
  - target: $["components"]["schemas"]["PlatformMetainfo"]["discriminator"]["mapping"]["google-cloud"]
    remove: true
  - target: $["components"]["schemas"]["PlatformMetainfo"]["oneOf"][*]
    remove: true
  - target: $["components"]["schemas"]["PlatformMetainfo"]["oneOf"]
    update:
      - $ref: "#/components/schemas/AwsBatchPlatformMetainfo"
      - $ref: "#/components/schemas/AwsCloudPlatformMetainfo"
      - $ref: "#/components/schemas/GooglePlatformMetainfo"
      - $ref: "#/components/schemas/AzBatchPlatformMetainfo"
      - $ref: "#/components/schemas/EksPlatformMetaInfo"
      - $ref: "#/components/schemas/GkePlatformMetaInfo"
      - $ref: "#/components/schemas/K8sPlatformMetaInfo"
      - $ref: "#/components/schemas/GridPlatformMetainfo"
      - $ref: "#/components/schemas/LocalPlatformMetainfo"
  - target: $["components"]["schemas"]["ProcessLoad"]["required"][*]
    remove: true
  - target: $["components"]["schemas"]["ProcessLoad"]["required"]
    update:
      - aborted
      - cached
      - cpuLoad
      - cpuTime
      - cpus
      - failed
      - invCtxSwitch
      - loadCpus
      - loadMemory
      - loadTasks
      - memoryReq
      - memoryRss
      - peakCpus
      - peakMemory
      - peakTasks
      - pending
      - process
      - readBytes
      - running
      - submitted
      - succeeded
      - volCtxSwitch
      - writeBytes
  - target: $["components"]["schemas"]["ProcessLoad"]["properties"]["retries"]
    remove: true
  - target: $["components"]["schemas"]["ProcessLoad"]["properties"]["ignored"]
    remove: true
  - target: $["components"]["schemas"]["ProcessLoad"]["properties"]["version"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["region"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["workDir"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["preRunScript"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["postRunScript"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["defaultDataRetentionPolicy"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["nextflowConfig"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]["properties"]["environment"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputeConfig"]
    update:
      allOf:
        - $ref: "#/components/schemas/AwsBatchConfig"
  - target: $["components"]["schemas"]["AzCloudConfig"]
    remove: true
  - target: $["components"]["schemas"]["GoogleBucket"]
    remove: true
  - target: $["components"]["schemas"]["GoogleCloudConfig"]
    remove: true
  - target: $["components"]["schemas"]["GoogleCloudPlatformMetaInfo"]
    remove: true
  - target: $["components"]["schemas"]["GoogleImage"]
    remove: true
  - target: $["components"]["schemas"]["GoogleInstanceType"]
    remove: true
  - target: $["components"]["schemas"]["Map.Entry_String.String_"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputePlatformDescriber"]
    remove: true
  - target: $["components"]["schemas"]["SeqeraComputePlatformMetainfo"]
    remove: true
  - target: $["components"]["schemas"]["WfFusionMeta"]
    remove: true
  - target: $["components"]["schemas"]["WfWaveMeta"]
  # Fix discriminator mapping validation errors by removing problematic mappings
  - target: $.components.schemas.ComputeConfig.discriminator.mapping["google-cloud"]
    remove: true
  - target: $.components.schemas.ComputeConfig.discriminator.mapping["azure-cloud"]
    remove: true
  - target: $.components.schemas.PlatformMetainfo.discriminator.mapping["seqeracompute"]
    remove: true
