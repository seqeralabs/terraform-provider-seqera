overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: GitHub Credentials Overlay
  version: 0.0.1

# ==============================================================================
# GITHUB CREDENTIALS RESOURCE OVERLAY
# ==============================================================================
#
# GitHub credentials store authentication information for accessing GitHub
# repositories within Seqera Platform workflows. Supports both GitHub.com
# and GitHub Enterprise instances.
#
# AUTHENTICATION METHOD:
# ----------------------
# Personal Access Token (PAT):
#   - GitHub username
#   - Personal access token with appropriate scopes
#   - Optional base_url for GitHub Enterprise
#
# VALIDATION RULES:
# -----------------
# - name: 2-99 alphanumeric characters with dashes/underscores (no spaces)
# - username: GitHub username
# - access_token: GitHub personal access token (sensitive, write-only)
# - base_url: Custom GitHub Enterprise URL (optional)
#
# TERRAFORM EXAMPLES:
# -------------------
#
# Example 1: GitHub.com credentials (most common)
# resource "seqera_github_credential" "basic" {
#   name         = "github-main"
#   workspace_id = seqera_workspace.main.id
#
#   username     = var.github_username
#   access_token = var.github_access_token
# }
#
# Example 2: GitHub Enterprise credentials
# resource "seqera_github_credential" "enterprise" {
#   name         = "github-enterprise"
#   workspace_id = seqera_workspace.main.id
#
#   username     = var.github_username
#   access_token = var.github_access_token
#   base_url     = "https://github.mycompany.com"
# }
#
# ==============================================================================

actions:
- target: $.paths
  update:
    /credentials#github:
      post:
        x-speakeasy-entity-operation:

          terraform-datasource: null

          terraform-resource: GithubCredential#create
        x-speakeasy-name-override: CreateGithubCredentials
        summary: Create GitHub credentials
        description: Creates new GitHub credentials in a user context. Append `?workspaceId` to create the credentials in
          a workspace context.
        tags:
        - credentials
        operationId: CreateGithubCredentials
        parameters:
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        requestBody:
          description: GitHub credentials create request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreateGithubCredentialsRequest'
          required: true
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/CreateGithubCredentialsResponse'
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
          '409':
            description: Conflict - resource already exists
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
        security:
        - BearerAuth: []
    /credentials/{credentialsId}#github:
      get:
        x-speakeasy-entity-operation:

          terraform-datasource: null

          terraform-resource: GithubCredential#read
        x-speakeasy-name-override: DescribeGithubCredentials
        summary: Describe GitHub credentials
        description: Retrieves the details of the GitHub credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: DescribeGithubCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        responses:
          '200':
            description: OK
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/DescribeGithubCredentialsResponse'
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
          '404':
            description: Not Found - Credential does not exist or has been deleted
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
        security:
        - BearerAuth: []
      put:
        x-speakeasy-entity-operation:

          terraform-datasource: null

          terraform-resource: GithubCredential#update
        x-speakeasy-name-override: UpdateGithubCredentials
        summary: Update GitHub credentials
        description: Updates the details of the GitHub credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: UpdateGithubCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        requestBody:
          description: GitHub credentials update request
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UpdateGithubCredentialsRequest'
          required: true
        responses:
          '204':
            description: OK - No content
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
        security:
        - BearerAuth: []
      delete:
        x-speakeasy-entity-operation:

          terraform-datasource: null

          terraform-resource: GithubCredential#delete
        x-speakeasy-name-override: DeleteGithubCredentials
        summary: Delete GitHub credentials
        description: Deletes the GitHub credentials identified by the given `credentialsId`.
        tags:
        - credentials
        operationId: DeleteGithubCredentials
        parameters:
        - name: credentialsId
          in: path
          description: Credentials string identifier
          required: true
          schema:
            type: string
        - name: workspaceId
          in: query
          description: Workspace numeric identifier
          schema:
            type: integer
            format: int64
        responses:
          '204':
            description: OK - No content
          '400':
            description: Bad request
            content:
              application/json:
                schema:
                  $ref: '#/components/schemas/ErrorResponse'
          '403':
            description: Operation not allowed
        security:
        - BearerAuth: []
- target: $.components.schemas
  update:
    GithubCredential:
      required:
      - name
      - keys
      type: object
      properties:
        credentials_id:
          type: string
          description: Unique identifier for the credential (max 22 characters)
          x-speakeasy-param-readonly: true
          x-speakeasy-param-suppress-computed-diff: true
        name:
          minLength: 2
          maxLength: 99
          type: string
          pattern: '^[a-zA-Z0-9_-]+$'
          description: Display name for the credential. Must be 2-99 characters using only letters, numbers, underscores, and hyphens. No spaces allowed.
          x-speakeasy-param-force-new: true
        provider:
          type: string
          enum:
          - github
          default: github
          description: Cloud provider type (automatically set to "github")
          x-speakeasy-name-override: providerType
          x-speakeasy-param-readonly: true
        deleted:
          type: boolean
          description: Flag indicating if the credential has been soft-deleted
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        lastUsed:
          type: string
          format: date-time
          description: Timestamp when the credential was last used
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        dateCreated:
          type: string
          format: date-time
          description: Timestamp when the credential was created
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        lastUpdated:
          type: string
          format: date-time
          description: Timestamp when the credential was last updated
          x-speakeasy-param-readonly: true
          x-speakeasy-terraform-ignore: true
        baseUrl:
          type: string
          description: 'Repository base URL for GitHub Enterprise Server (optional). Leave empty for GitHub.com. Example:
            https://github.mycompany.com'
          example: https://github.mycompany.com
          x-speakeasy-name-override: base_url
          x-speakeasy-param-computed: false
        keys:
          x-speakeasy-entity: GithubCredential
          x-speakeasy-terraform-resource-name: github_credential
          x-speakeasy-entity-description: 'Manage GitHub credentials in Seqera platform using this resource.


            GitHub credentials store authentication information for accessing GitHub

            repositories within the Seqera Platform workflows.

            '
          type: object
          required:
          - username
          - password
          properties:
            username:
              type: string
              description: GitHub username associated with the Personal Access Token (required)
              example: octocat
            password:
              type: string
              description: GitHub Personal Access Token (PAT) for authentication (required, sensitive)
              x-speakeasy-param-sensitive: true
              x-speakeasy-terraform-write-only: true
              example: ghp_1234567890abcdefghijklmnopqrstuvwxyz
              x-speakeasy-name-override: access_token
    CreateGithubCredentialsRequest:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/GithubCredential'
    CreateGithubCredentialsResponse:
      type: object
      properties:
        credentialsId:
          type: string
    UpdateGithubCredentialsRequest:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/GithubCredential'
    DescribeGithubCredentialsResponse:
      type: object
      properties:
        credentials:
          $ref: '#/components/schemas/GithubCredential'
- target: $.components.schemas.GithubCredential.properties.description
  remove: true
- target: $.components.schemas.GithubCredential.properties.category
  remove: true
- target: $.components.schemas.GithubCredential.properties.keys.properties.password
  update:
    writeOnly: true
- target: $["paths"]["/credentials#github"]["post"]["parameters"][?(@.name == "workspaceId")]
  update:
    x-speakeasy-param-force-new: true
