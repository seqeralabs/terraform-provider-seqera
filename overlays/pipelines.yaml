overlay: 1.0.0
x-speakeasy-jsonpath: rfc9535
info:
  title: Pipelines Overlay
  version: 0.0.0
actions:
  # Pipeline request schema annotations
  - target: $["components"]["schemas"]["CreatePipelineRequest"]["properties"]["name"]
    update:
      x-speakeasy-param-optional: false
      example: "nf-core-rnaseq"
  - target: $["components"]["schemas"]["CreatePipelineRequest"]["properties"]["description"]
    update:
      example: "RNA-Seq analysis pipeline using nf-core best practices"
  - target: $["components"]["schemas"]["CreatePipelineResponse"]
    update:
      x-speakeasy-entity: Pipelines

  # Pipeline entity annotations
  - target: $["components"]["schemas"]["PipelineDbDto"]
    update:
      x-speakeasy-entity: Pipeline
      x-speakeasy-entity-description: |
        Manage Nextflow pipeline definitions and configurations.

        Pipelines define reusable workflow templates with parameters,
        compute environment settings, and execution configurations
        for scalable bioinformatics and data processing workflows.
  - target: $["components"]["schemas"]["PipelineInfo"]["properties"]["provider"]
    update:
      x-speakeasy-name-override: repositoryProvider

  # Pipeline entity operations
  - target: $.paths["/pipelines"].post
    update:
      x-speakeasy-entity-operation: Pipeline#create
  - target: $.paths["/pipelines/{pipelineId}"].get
    update:
      x-speakeasy-entity-operation: Pipeline#read
  - target: $.paths["/pipelines/{pipelineId}"].put
    update:
      x-speakeasy-entity-operation: Pipeline#update
  - target: $.paths["/pipelines/{pipelineId}"].delete
    update:
      x-speakeasy-entity-operation: Pipeline#delete

  # Mark server-managed fields as read-only
  - target: $["components"]["schemas"]["PipelineDbDto"]["properties"]["lastUpdated"]
    update:
      x-speakeasy-param-readonly: true
  - target: $["components"]["schemas"]["PipelineDbDto"]["properties"]["deleted"]
    update:
      x-speakeasy-param-readonly: true

  # Mark workspaceId as required for pipelines GET endpoint to fix import
  - target: $.paths["/pipelines/{pipelineId}"].get.parameters[?(@.name == "workspaceId")]
    update:
      name: workspaceId
      in: query
      description: Workspace numeric identifier
      required: true
      schema:
        type: integer
        format: int64
